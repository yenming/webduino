<!doctype html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Transcript 1-11</title>
<script src="https://blocklypro.webduino.io/components/jquery/dist/jquery.min.js"></script>
<script src="https://blocklypro.webduino.io/dist/lib/webduino-all-0.4.20.min.js"></script>
<script src="https://blocklypro.webduino.io/dist/webduino-blockly.min.js"></script>
<script src="https://blocklypro.webduino.io/dist/lib/firebase.min.js"></script>
<script src="https://blocklypro.webduino.io/dist/lib/runtime.min.js"></script>
<script src="https://rawgit.com/fustyles/webduino/temp/GameElements_20180910/gameelements.js"></script>
<style id="jsbin-css">
#demo-area-01-show { font-size: 60px; pointer-events: auto!important; }
</style>
</head>
<body>
身分證字號後六碼：<input type="text" id="sid" name="sid" size="10"><input type="button" value="查詢" onclick="getData((text_to_number((_E8_AE_8A_E6_95_B8.indexOf(id) + 1))));">
<div><span id="demo-area-01-show"></span></div>
  
<script id="jsbin-javascript">

(async function () {

var id;
var row;
var _E8_AE_8A_E6_95_B8;
var fuGameTable;
var myData;
var i;
var Data;
  
id = '389028';
_E8_AE_8A_E6_95_B8 = '762250,389028,159569,763613,382609,761315,383795,608795,652099,389073,761708,760479,763266,687332,765859,371947,368762,815781,923706,819421,815709,683163,533715,923475,544330,815638,342455,919668,374347'.split(',');
getData((text_to_number((_E8_AE_8A_E6_95_B8.indexOf(id) + 1))));  

async function getData(row) {
  table_create("fuGameTable",0,0,0,100,30,2,"solid",0,'#000000','#ffffff',0,true);
  myData= {};
  myData.sheetUrl = 'https://docs.google.com/spreadsheets/d/1HmADQBBHmQTnfSNzedgrzblD4cB56Ol7M0nafVizaC8/edit?usp=sharing';
  myData.sheetName = '111';
  readSheetData({
    row : (row + 1),
    col : 1,
    sheetUrl : myData.sheetUrl,
    sheetName : myData.sheetName
  }, function(googleSheetReadData){
    document.getElementById('demo-area-01-show').innerHTML = googleSheetReadData;
  });
  for (i = 2; i <= 30; i++) {
    Data = '';
    readSheetData({
      row : 1,
      col : i,
      sheetUrl : myData.sheetUrl,
      sheetName : myData.sheetName
    }, function(googleSheetReadData){
      Data = googleSheetReadData;
      table_td_set("fuGameTable",0,(i - 2),"textalign",'left');
      table_td_insert_text("fuGameTable",0,(i - 2),Data,'Arial',8,'#000000');
    });
    readSheetData({
      row : (row + 1),
      col : i,
      sheetUrl : myData.sheetUrl,
      sheetName : myData.sheetName
    }, function(googleSheetReadData){
      table_td_set("fuGameTable",1,(i - 2),"textalign",'right');
      table_td_insert_text("fuGameTable",1,(i - 2),googleSheetReadData,'Arial',8,'#ff0000');
    });
    await delay(2);
    if (Data == '') {
      break;
    }
  }
}

}());
</script>
</body>
</html>
